\documentclass[journal]{IEEEtran}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[polish]{babel}
\pagestyle{plain}
\setlength{\parskip}{0.7em}  
\setlength{\parindent}{15pt}


\ifCLASSINFOpdf
  
\else
 
\fi





% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}


\begin{document}

\title{ECG vs PPG}
\author{
    J. Bancerewicz, J. Kotłowski, O. Lozovyy, J. Morawska, M. Rzęsa\\
    \textit{Politechnika Gdańska}\\
    \textit{Wydział Elektroniki, Telekomunikacji i Informatyki}
}


% The paper headers
\markboth{}%
{Shell \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for IEEE Journals}
\maketitle

% As a general rule, do not put math, special symbols or citations
% in the abstract or keywords.
\begin{abstract}
The abstract goes here.
\end{abstract}

% Note that keywords are not normally used for peerreview papers.
\begin{IEEEkeywords}
IEEE, IEEEtran, journal, \LaTeX, paper, template.
\end{IEEEkeywords}

\IEEEpeerreviewmaketitle



\section{Wstęp}

\IEEEPARstart{T}{his} demo file is intended to serve as a ``starter file''
for IEEE journal papers produced under \LaTeX\ using
IEEEtran.cls version 1.8b and later.

\newpage
\section{Przegląd metod z użyciem uczenia maszynowego}
Analiza sygnałów elektrokardiograficznych coraz częściej wykorzystuje metody uczenia maszynowego, jak sieci splotowe czy rekurencyjne, ze względu na możliwość detekcji złożonych zależności czasowych. W związku z wysoką odpornością na szumy i zakłócenia modele oparte na CNN implementowane są do automatycznej detekcji załamków R. 

W literaturze opisywane są również klasyczne metody, takie jak filtry progowe czy transformacje sygnału. Ich zastosowanie w warunkach rzeczywistych jest utrudnione spadkiem efektywności w obecności zakłóceń spowodowanych ruchem. W odpowiedzi na ograniczenia, wykorzstuje się modele głębokiego uczenia, które posiadają zdolność do samodzielnego wyodrębniania istotnych cech bez potrzeby stosowania ręcznie definiowanych progów lub filtrów \cite{1}.

Algorytm Pan-Tompkins, mimo powszechnego zastosowania w analizie sygnału EKG, charakteryzuje się niewystarczającą skutecznością w warunkach niskiej jakości sygnału. Ze względu na zdolność predykcji przebiegów czasowych sieci LSTM, stosowane są do wykrywania korelacji między obserwacjami interwałów RR, stanowią istotne narzędzie w analizie zmienności rytmu serca.


Model wykorzystujący połączenie sieci splotowych i rekurencyjnych umożliwia jednoczesną detekcje krótkozasięgowych zmian w sygnale oraz długoterminowych zależności czasowych, co ma szczególne znaczenie w analizie nieregularnych sygnałów EKG \cite{2}. Niezależne zastosowanie rozwiązania CNN może prowadzić do utraty dynamiki przebiegu czasowego, natomiast sieci LSTM bez ekstrakcji cech są podatne na zakłócenia w danych wejściowych \cite{3}.

-----------------------------------------------------------------
% Tu dodać o PPG jak będzie sieć i jak jest widoczne PPG w nauce
%Tu dodac o metodach z hrv  jak są brane z ECG i PGG po PPG

\newpage
\subsection{Elektrokardiografia}
W niniejszej pracy została zaprojektowana sieć łącząca warstwy splotowe oraz rekurencyjne, przeznaczoną do rozpoznawania szczytów R w sygnale EKG. Stanowi ona pierwszy etap w procesie wyznaczania interwałów RR oraz parametrów zmienności rytmu serca.

Model przetwarza jednowymiarowe sygnały napięcia elektrycznego, podzielone na fragmenty o długości 256 próbek. Moduły splotowe odpowiadają za ekstrakcję cech z danych wejściowych przez zastosowanie kolejnych warstw konwolucyjnych wraz z nieliniowymi funkcjami aktywacji. Realizacja procesu redukcji wymiarowości przez wybór największych wartości pozwala na zwiększenie odporności na szum oraz zakłócenia. Po przekształceniu sygnału przez część konwolucyjną, dane są przekazywane do jednokierunkowej warstwy LSTM, która umożliwia analizę zależności czasowych między kolejnymi próbkami sygnału. W końcowej części modelu wykorzystano połączone moduły liniowe, których celem jest przekształcenie wewnętrznej reprezentacji cech w przestrzeń logitów. Każdy element wektora odpowiada prawdopodobieństwu wystąpienia załamka R w odpowiadającej mu próbce sygnału wejściowego. Zaprojektowane rozwiązanie umożliwia binarną klasyfikację dla każdej próbki w szeregu czasowym.

Model został wytrenowany w trybie nadzorowanym na podstawie sygnałów pochodzących z czujnika tętna Polar H10. Do przygotowania danych treningowych wykorzystano funkcję ecg\_peaks z biblioteki NeuroKit2, implementującą algorytm Pan–Tompkins, który umożliwia detekcję załamków R w surowym sygnale EKG. Dla każdej próbki przygotowano etykiety binarne wskazujące obecność lub brak lokalnego maksimum. W rezultacie sieć neuronowa uczyła się realizować klasyfikację fragmentów sygnału EKG poprzez identyfikację wzorców odpowiadającym rzeczywistym szczytom R.


\subsection{Fotopletyzmografia}
-----------------------------------------------------------------
% Tu dodać o PPG jak będzie sieć jak jest zrobiona

-----------------------------------------------------------------

\newpage
\section{Opis systemu i danych}

\subsection{Akwizacja danych EKG}
Dane wykorzystane do trenowania i walidacji modelu detekcji załamków R zostały pozyskane za pomocą pulsometru Polar H10, umożliwiającego rejestrację sygnału elektrokardiograficznego z częstotliwością próbkowania wynoszącą 130 Hz. Zastosowana częstotliwość próbkowania umożliwia charakterystykę przebiegu sygnału istotną dla oceny aktywności serca oraz analizy zmienności rytmu zatokowego.

W celu zgromadzenia odpowiedniego zbioru danych przeprowadzono dwugodzinne eksperymenty pomiarowe z udziałem pięciu osób. Rejestrowane przebiegi były zróżnicowane pod względem poziomu aktywności fizycznej, zmienności rytmu serca, a także obecnością nagłych ruchów ciała, mogących wprowadzać zakłócenia w sygnale.

Transmisja danych między czujnikiem a komputerem realizowana była bezprzewodowo z wykorzystaniem technologii Bluetooth Low Energy. Dane przesyłano w czasie rzeczywistym w pakietach zawierających około 13 próbek, zgodnych z zastosowaną częstotliwością próbkowania, a następnie zapisywano je w formacie CSV. Każda próbka odpowiadała wartości potencjału elektrycznego rejestrowanego z powierzchni klatki piersiowej użytkownika.

\subsection{Filtracja sygnału – filtr Butterwortha}
Do przetwarzania sygnału EKG wykorzystano cyfrowy filtr Butterwortha piątego rzędu o charakterystyce pasmowo-przepustowej, obejmującej zakres częstotliwości od 0,5 Hz do 45 Hz, w celu eliminacji szumów oraz zakłóceń. Dolna granica filtru redukuje powolne zmiany w sygnale wywołane ruchem ciała lub niestabliną pozycją elektrod  \cite{4}. Z kolei górna granica tłumi zakłócenia sieciowe, elektromagnetyczne oraz mięśniowe  \cite{5}. Filtracja danych została przeprowadzona przy użyciu funkcji nk.signal\_filter z biblioteki NeuroKit2.


----------------------------------------------------------------
% Tu nałożone dwa sygnały
----------------------------------------------------------------

\newpage
\subsection{Model do wykrywania załamków R}
Sieć neuronowa została zaimplementowana z wykorzystaniem biblioteki PyTorch. Architektura składa się z czterech warstw splotowych typu 1D, jednokierunkowej warstwy LSTM oraz bloków dwóch warstw liniowych. Sygnał wejściowy ma postać jednowymiarowej sekwencji o wymiarach [1 × 256], zawierającą 256 próbek w pojedynczym kanale.

Pierwszy etap obejmuje ekstrakcję cech przy użyciu czterech warstw konwolucyjnych 1D, których parametry zestawiono w Tabeli~\ref{tab:conv_layers}. Każda warstwa rozszerza reprezentację sygnału, zwiększając liczbę kanałów od 16 do 128, wykorzystując filtry o rozmiarach 5 lub 3. Dla każdego przekształcenia zastosowano normalizację BatchNorm1d oraz nieliniową funkcję aktywacji LeakyReLU. Maksymalne próbkowanie MaxPooling1D z jądrem o rozmiarze 2 redukuje długość sekwencji z 256 do 16 wzdłuż osi czasowej, zwiększając efektywność przetwarzania.

Macierz danych o wymiarach [128 × 16] jest przekształcana przez jednokierunkową LSTM z 128 jednostkami ukrytymi, działającą w trybie batch\_first=True. Otrzymany wektor jest spłaszczany i przekazywany do warstwy z 128 neuronami, a następnie do końcowego bloku zawierającego 256 neuronów, odwzorowującego kolejne próbki sygnału wejściowego. Każdy logit w wektorze reprezentuje miarę pewności modelu dotyczącą obecności piku R w danej próbce.

Trening modelu przeprowadzono w trybie nadzorowanym, w partiach po 32 próbki, z wykorzystaniem funkcji straty BCEWithLogitsLoss, umożliwiającej binarną klasyfikację próbek sygnału. Do optymalizacji zastosowano algorytm Adam przy stałej wartości współczynnika uczenia wynoszącej 0,0001.

\begin{table}[h!]
\centering
\caption{Parametry warstw konwolucyjnych sieci}
\label{tab:conv_layers}
\begin{tabular}{|l|c|c|c|c|c|}
\hline
\textbf{Warstwa} & \textbf{Wejście} & \textbf{Wyjście} & \textbf{Filtr} & \textbf{Padding} & \textbf{Aktywacja} \\
\hline
Conv1D-1 & 1   & 16  & 5 & 2 & LReLU+BN \\
Conv1D-2 & 16  & 32  & 5 & 2 & LReLU+BN \\
Conv1D-3 & 32  & 64  & 3 & 1 & LReLU+BN \\
Conv1D-4 & 64  & 128 & 3 & 1 & LReLU+BN \\
\hline
\end{tabular}
\end{table}

Efektywność zaprojektowanej sieci neuronowej oceniono na podstawie wyników uzyskanych na niezależnym zbiorze danych, wykorzystując wytrenowane parametry modelu. Rezultaty klasyfikacji przedstawiono w postaci macierzy konfuzji w Tabeli~\ref{tab:conf_matrix}.

\begin{table}[ht]
\centering
\caption{Macierz konfuzji dla detekcji załamków R}
\label{tab:conf_matrix}
\begin{tabular}{|c|c|c|}
\hline
\textbf{Rzeczywiste / Predykcja} & \textbf{Brak szczytu R} & \textbf{Szczyt R} \\
\hline
Brak szczytu R & 231170 & 53 \\
\hline
Szczyt R & 83 & 2678 \\
\hline
\end{tabular}
\end{table}

\newpage
Model poprawnie zaklasyfikował 231170 próbek niezawierających piku R oraz 2678 z jego rzeczywistą obecnością. Liczba fałszywie pozytywnych predykcji wyniosła 53, natomiast fałszywie negatywnych -- 83. Wartość miary F1 równa 0,9753 świadczy o wysokiej równowadze pomiędzy precyzją a czułością modelu, co jest kluczowe w automatycznej analizie sygnałów elektrokardiograficznych. Podstawowe metryki oceny jakości modelu przedstawiono w Tabeli~\ref{tab:metrics}.

\begin{table}[ht]
\centering
\caption{Parametry detekcji szczytów R}
\label{tab:metrics}
\begin{tabular}{|c|c|p{4.6cm}|}
\hline
\textbf{Metryka} & \textbf{Wartość} & \textbf{Opis} \\
\hline
Skuteczność & 96,99\% & Odsetek poprawnych klasyfikacji obecności lub braku piku R. \\
\hline
Błędne detekcje & 0,00\% & Odsetek próbek fałszywie zaklasyfikowanych jako zawierające pik R. \\
\hline
Pominięte załamki & 3,01\% & Odsetek próbek z niewykrytym rzeczywistym pikiem R. \\
\hline
\end{tabular}
\end{table}


\subsection{Akwizacja danych PPG}




\begin{thebibliography}{1}
\bibitem{1}
 O. Faust, U. R. Acharya, H. Adeli, and A. Adeli, "Deep learning for healthcare applications based on physiological signals: A review"
\bibitem{2}
 Rajpurkar, P., Hannun, A. Y., Haghpanahi, M., Bourn, C., & Ng, A. Y. (2017), "Cardiologist-level arrhythmia detection with convolutional neural networks"
\bibitem{3}
 Yildirim, O. (2018), "A novel wavelet sequence based on deep bidirectional LSTM network model for ECG signal classification. Computers in Biology and Medicine"
\bibitem{4} 
 G. Lenis, N. Pilia, A. Loewe, W. H. W. Schulze, and O. Dössel, "Comparison of Baseline Wander Removal Techniques considering the Preservation of ST Changes in the Ischemic ECG: A Simulation Study"
\bibitem{5} 
 R. J. Martis, U. R. Acharya, H. Adeli, "Current methods in electrocardiogram characterization"

\end{thebibliography}
\end{document}


